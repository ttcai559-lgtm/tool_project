# åª’ä½“ç®¡ç†åŠŸèƒ½è¯´æ˜

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

åª’ä½“ç®¡ç†ï¼ˆEnvironment Managementï¼‰åŠŸèƒ½å…è®¸ä½ ä¸ºä¸åŒçš„æµ‹è¯•ç¯å¢ƒé…ç½®åŸºç¡€URLå’Œé»˜è®¤å‚æ•°ï¼Œç±»ä¼¼äºPostmançš„EnvironmentåŠŸèƒ½ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

### 1. ç¯å¢ƒé…ç½®
æ¯ä¸ªç¯å¢ƒï¼ˆåª’ä½“ï¼‰åŒ…å«ï¼š
- **åç§°**: ç¯å¢ƒæ ‡è¯†ï¼ˆå¦‚ï¼šå¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒï¼‰
- **åŸºç¡€URL**: APIçš„åŸºç¡€åœ°å€
- **é»˜è®¤Headers**: æ‰€æœ‰è¯·æ±‚å…±ç”¨çš„è¯·æ±‚å¤´
- **é»˜è®¤å‚æ•°**: æ‰€æœ‰è¯·æ±‚å…±ç”¨çš„æŸ¥è¯¢å‚æ•°
- **æè¿°**: ç¯å¢ƒè¯´æ˜ï¼ˆå¯é€‰ï¼‰

### 2. å¿«é€Ÿåˆ‡æ¢
- åœ¨ä¸»é¡µé¢é¡¶éƒ¨çš„ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©ç¯å¢ƒ
- åˆ‡æ¢ç¯å¢ƒæ—¶è‡ªåŠ¨åº”ç”¨è¯¥ç¯å¢ƒçš„é…ç½®
- è¯·æ±‚URLä¼šè‡ªåŠ¨æ›¿æ¢ä¸ºç¯å¢ƒçš„åŸºç¡€URL
- é»˜è®¤Headerså’Œå‚æ•°ä¼šè‡ªåŠ¨åˆå¹¶åˆ°è¯·æ±‚ä¸­

### 3. ç¯å¢ƒç®¡ç†
- **æ–°å»ºç¯å¢ƒ**: åˆ›å»ºæ–°çš„æµ‹è¯•ç¯å¢ƒé…ç½®
- **ç¼–è¾‘ç¯å¢ƒ**: ä¿®æ”¹ç°æœ‰ç¯å¢ƒçš„é…ç½®
- **åˆ é™¤ç¯å¢ƒ**: ç§»é™¤ä¸éœ€è¦çš„ç¯å¢ƒ
- **å¯¼å…¥/å¯¼å‡º**: YAMLæ ¼å¼ï¼Œæ˜“äºç‰ˆæœ¬æ§åˆ¶

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åˆ›å»ºç¯å¢ƒ

1. ç‚¹å‡»ä¸»é¡µé¢å³ä¸Šè§’çš„ **"åª’ä½“ç®¡ç†"** æŒ‰é’®
2. ç‚¹å‡» **"æ–°å»ºåª’ä½“"** æŒ‰é’®
3. å¡«å†™ç¯å¢ƒä¿¡æ¯ï¼š
   ```yaml
   åç§°: å¼€å‘ç¯å¢ƒ
   åŸºç¡€URL: https://api-dev.example.com
   é»˜è®¤Headers:
   {
     "Content-Type": "application/json",
     "Authorization": "Bearer dev-token"
   }
   é»˜è®¤å‚æ•°:
   {
     "version": "1.0",
     "env": "dev"
   }
   æè¿°: å¼€å‘ç¯å¢ƒé…ç½®
   ```
4. ç‚¹å‡» **"ä¿å­˜"**

### ä½¿ç”¨ç¯å¢ƒ

1. åœ¨ä¸»é¡µé¢é¡¶éƒ¨é€‰æ‹©ç¯å¢ƒ
2. ç¯å¢ƒé…ç½®ä¼šè‡ªåŠ¨åº”ç”¨åˆ°å½“å‰è¯·æ±‚
3. å‘é€è¯·æ±‚æ—¶ä¼šä½¿ç”¨ç¯å¢ƒçš„åŸºç¡€URLå’Œé»˜è®¤é…ç½®

### åˆ‡æ¢ç¯å¢ƒç¤ºä¾‹

å‡è®¾ä½ æœ‰ä»¥ä¸‹ç¯å¢ƒï¼š

**å¼€å‘ç¯å¢ƒ**
```yaml
base_url: https://api-dev.example.com
default_headers:
  Authorization: Bearer dev-token-123
```

**ç”Ÿäº§ç¯å¢ƒ**
```yaml
base_url: https://api.example.com
default_headers:
  Authorization: Bearer prod-token-456
```

å½“ä½ çš„æµ‹è¯•ç”¨ä¾‹URLæ˜¯ `/users/list` æ—¶ï¼š
- é€‰æ‹©"å¼€å‘ç¯å¢ƒ" â†’ å®é™…è¯·æ±‚ï¼š`https://api-dev.example.com/users/list`
- é€‰æ‹©"ç”Ÿäº§ç¯å¢ƒ" â†’ å®é™…è¯·æ±‚ï¼š`https://api.example.com/users/list`

## ğŸ“‚ æ–‡ä»¶å­˜å‚¨

ç¯å¢ƒé…ç½®ä¿å­˜åœ¨ `testforge/environments/` ç›®å½•ä¸‹ï¼š

```
testforge/
â”œâ”€â”€ environments/
â”‚   â”œâ”€â”€ .gitkeep
â”‚   â”œâ”€â”€ å¼€å‘ç¯å¢ƒ.yaml
â”‚   â”œâ”€â”€ æµ‹è¯•ç¯å¢ƒ.yaml
â”‚   â””â”€â”€ ç”Ÿäº§ç¯å¢ƒ.yaml
```

**é…ç½®æ–‡ä»¶ç¤ºä¾‹** (`å¼€å‘ç¯å¢ƒ.yaml`):
```yaml
name: å¼€å‘ç¯å¢ƒ
base_url: https://api-dev.example.com
default_headers:
  Content-Type: application/json
  Authorization: Bearer dev-token-123
default_params:
  version: '1.0'
  env: dev
description: å¼€å‘ç¯å¢ƒé…ç½®
metadata:
  created_at: '2025-11-26T00:00:00'
  updated_at: '2025-11-26T00:00:00'
  version: '1.0'
```

## ğŸ”§ APIæ¥å£

### åç«¯API

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| GET | `/api/environments` | è·å–æ‰€æœ‰ç¯å¢ƒ |
| GET | `/api/environments/{name}` | è·å–æŒ‡å®šç¯å¢ƒ |
| POST | `/api/environments` | ä¿å­˜ç¯å¢ƒ |
| DELETE | `/api/environments/{name}` | åˆ é™¤ç¯å¢ƒ |

### æ•°æ®æ¨¡å‹

```typescript
interface Environment {
  name: string;
  base_url: string;
  default_headers?: Record<string, string>;
  default_params?: Record<string, string>;
  description?: string;
  metadata?: {
    created_at: string;
    updated_at: string;
    version: string;
  };
}
```

## ğŸ’¡ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: å¤šç¯å¢ƒæµ‹è¯•

```
å¼€å‘ç¯å¢ƒ  â†’ https://api-dev.example.com
æµ‹è¯•ç¯å¢ƒ  â†’ https://api-test.example.com
é¢„å‘ç¯å¢ƒ  â†’ https://api-staging.example.com
ç”Ÿäº§ç¯å¢ƒ  â†’ https://api.example.com
```

### åœºæ™¯2: ä¸åŒè®¤è¯Token

```
å¼€å‘ç¯å¢ƒ  â†’ Authorization: Bearer dev-token
æµ‹è¯•ç¯å¢ƒ  â†’ Authorization: Bearer test-token
```

### åœºæ™¯3: ä¸åŒAPIç‰ˆæœ¬

```
V1ç¯å¢ƒ    â†’ base_url: https://api.example.com/v1
V2ç¯å¢ƒ    â†’ base_url: https://api.example.com/v2
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å‘½åè§„èŒƒ
- ä½¿ç”¨æ¸…æ™°çš„ç¯å¢ƒåç§°ï¼š`å¼€å‘ç¯å¢ƒ`ã€`æµ‹è¯•ç¯å¢ƒ`ã€`ç”Ÿäº§ç¯å¢ƒ`
- é¿å…ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œä½¿ç”¨ä¸­æ–‡æˆ–è‹±æ–‡

### 2. Tokenç®¡ç†
- ä¸è¦åœ¨ä»£ç ä»“åº“ä¸­æäº¤åŒ…å«æ•æ„ŸTokençš„é…ç½®
- ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–é…ç½®ç®¡ç†å·¥å…·
- `.gitignore` å·²é…ç½®å¿½ç•¥ç¯å¢ƒé…ç½®æ–‡ä»¶

### 3. å›¢é˜Ÿåä½œ
- æä¾›ç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `example_dev.yaml`ï¼‰
- å›¢é˜Ÿæˆå‘˜åŸºäºç¤ºä¾‹åˆ›å»ºè‡ªå·±çš„ç¯å¢ƒé…ç½®
- åœ¨READMEä¸­è¯´æ˜å¿…éœ€çš„ç¯å¢ƒé…ç½®

### 4. ç‰ˆæœ¬æ§åˆ¶
- ç¯å¢ƒé…ç½®ä½¿ç”¨YAMLæ ¼å¼ï¼Œæ˜“äºç‰ˆæœ¬æ§åˆ¶
- å¯ä»¥å°†ç¯å¢ƒé…ç½®æ¨¡æ¿æäº¤åˆ°Git
- å®é™…çš„Tokenå’Œæ•æ„Ÿä¿¡æ¯ä».gitignoreæ’é™¤

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

1. **ä¸è¦æäº¤æ•æ„Ÿä¿¡æ¯**
   - Tokenã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ä¸åº”æäº¤åˆ°Git
   - ä½¿ç”¨ `.gitignore` æ’é™¤å®é™…çš„ç¯å¢ƒé…ç½®

2. **ä½¿ç”¨ç¯å¢ƒå˜é‡**
   - å¯ä»¥åœ¨é…ç½®ä¸­ä½¿ç”¨å ä½ç¬¦
   - éƒ¨ç½²æ—¶æ›¿æ¢ä¸ºå®é™…å€¼

3. **æƒé™æ§åˆ¶**
   - ç”Ÿäº§ç¯å¢ƒé…ç½®åº”æœ‰ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶
   - å®šæœŸæ›´æ–°Token

## ğŸ“š ç›¸å…³æ–‡ä»¶

**åç«¯ï¼š**
- `src/storage/environment_storage.py` - ç¯å¢ƒå­˜å‚¨å±‚
- `src/api/main.py` - ç¯å¢ƒç®¡ç†API

**å‰ç«¯ï¼š**
- `src/pages/Environments.tsx` - ç¯å¢ƒç®¡ç†é¡µé¢
- `src/pages/Index.tsx` - ç¯å¢ƒé€‰æ‹©å™¨
- `src/lib/api.ts` - APIå®¢æˆ·ç«¯

**é…ç½®ï¼š**
- `environments/` - ç¯å¢ƒé…ç½®ç›®å½•
- `.gitignore` - å¿½ç•¥æ•æ„Ÿé…ç½®

## ğŸ‰ åŠŸèƒ½ä¼˜åŠ¿

1. **æé«˜æ•ˆç‡**: ä¸€é”®åˆ‡æ¢ç¯å¢ƒï¼Œæ— éœ€æ‰‹åŠ¨ä¿®æ”¹URL
2. **å‡å°‘é”™è¯¯**: é¿å…åœ¨ä¸åŒç¯å¢ƒé—´å¤åˆ¶é”™è¯¯çš„é…ç½®
3. **æ˜“äºç®¡ç†**: é›†ä¸­ç®¡ç†æ‰€æœ‰ç¯å¢ƒé…ç½®
4. **å›¢é˜Ÿåä½œ**: å›¢é˜Ÿæˆå‘˜å¯ä»¥å…±äº«ç¯å¢ƒé…ç½®æ¨¡æ¿
5. **ç‰ˆæœ¬æ§åˆ¶**: YAMLæ ¼å¼ä¾¿äºGitç®¡ç†

## ğŸš¦ å¿«é€Ÿå¼€å§‹

1. **è®¿é—®åª’ä½“ç®¡ç†é¡µé¢**: http://localhost:8080/environments
2. **åˆ›å»ºç¬¬ä¸€ä¸ªç¯å¢ƒ**:
   - åç§°: æµ‹è¯•ç¯å¢ƒ
   - åŸºç¡€URL: https://your-api-domain.com
   - ä¿å­˜

3. **è¿”å›ä¸»é¡µé¢**: http://localhost:8080
4. **é€‰æ‹©ç¯å¢ƒ**: åœ¨é¡¶éƒ¨ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©"æµ‹è¯•ç¯å¢ƒ"
5. **å¼€å§‹æµ‹è¯•**: å‘é€è¯·æ±‚æ—¶ä¼šè‡ªåŠ¨ä½¿ç”¨ç¯å¢ƒé…ç½®

---

**æç¤º**: å‚è€ƒ `environments/example_dev.yaml` æŸ¥çœ‹é…ç½®ç¤ºä¾‹ï¼
